<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Deep Cleaning Price Calculator</title>

  <script type="text/javascript">
    (function(c,l,a,r,i,t,y){
        c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
        t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
        y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
    })(window, document, "clarity", "script", "vj9i1sfm9b");
  </script>

  <style>
    :root{
      --bg:#f5f7fb;
      --card:#ffffff;
      --text:#121212;
      --muted:#5c636b;
      --border:rgba(18,18,18,.12);

      --accent:#f5c400;
      --accent2:#ffdf6a;
      --accentDark:#1a1a1a;
      --shadow: 0 18px 55px rgba(0,0,0,.10);
      --radius:20px;
      --btnH:56px;
    }

    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background:
        radial-gradient(900px 520px at 25% 0%, rgba(245,196,0,.22), transparent 60%),
        radial-gradient(760px 520px at 85% 10%, rgba(26,26,26,.10), transparent 55%),
        var(--bg);
      color:var(--text);
    }
    a{color:inherit}
    .wrap{max-width:1100px;margin:0 auto;padding:24px}
    .hero{
      background: linear-gradient(180deg, rgba(245,196,0,.26), rgba(245,196,0,.08));
      border:1px solid rgba(245,196,0,.55);
      border-radius: var(--radius);
      padding:22px;
      box-shadow: var(--shadow);
      position:relative;
      overflow:hidden;
    }
    .hero:after{
      content:"";
      position:absolute;right:-120px;top:-140px;
      width:340px;height:340px;border-radius:50%;
      background: rgba(26,26,26,.08);
    }
    .badge{
      display:inline-flex;gap:8px;align-items:center;
      padding:7px 12px;border-radius:999px;
      background: rgba(26,26,26,.92);
      border:1px solid rgba(26,26,26,.92);
      color:#fff;
      font-size:12px;
      letter-spacing:.2px;
    }
    h1{margin:10px 0 6px;font-size:30px;line-height:1.1}
    .sub{margin:0;color:rgba(18,18,18,.78);max-width:860px}
    .heroRow{display:flex;gap:12px;flex-wrap:wrap;margin-top:14px}
    .heroPill{
      padding:10px 12px;border-radius:16px;
      background: rgba(255,255,255,.85);
      border:1px solid rgba(18,18,18,.10);
      font-weight:800;
      font-size:14px;
    }
    .heroPill b{color:var(--accentDark)}

    .grid{
      display:grid;
      grid-template-columns: 1.05fr .95fr;
      gap:16px;
      margin-top:16px;
      align-items:start;
    }
    @media (max-width: 980px){ .grid{grid-template-columns:1fr} }

    .card{
      background: var(--card);
      border:1px solid var(--border);
      border-radius: var(--radius);
      padding:18px;
      box-shadow: var(--shadow);
    }
    .card h2{margin:0 0 6px;font-size:18px}
    .muted{color:var(--muted);font-size:13px}

    label{display:block;margin:12px 0 6px;font-size:14px;color: rgba(18,18,18,.88)}
    input, textarea, select{
      width:100%;
      padding:12px 12px;
      border-radius: 16px;
      border: 1px solid var(--border);
      background:#fff;
      color:var(--text);
      font-size:15px;
      outline:none;
    }
    textarea{resize:vertical;min-height:104px}
    input::placeholder, textarea::placeholder{color: rgba(18,18,18,.45)}

    .row{display:grid;grid-template-columns: 1fr 1fr;gap:12px}
    @media (max-width: 560px){ .row{grid-template-columns:1fr} }

    .unitbar{
      display:flex;gap:10px;align-items:center;justify-content:space-between;
      padding:10px 12px;border-radius: 16px;
      border:1px solid var(--border);
      background: rgba(245,247,251,.95);
      margin-top:10px;
    }
    .seg{
      display:flex;gap:6px;align-items:center;
      border:1px solid var(--border);
      background:#fff;
      border-radius:999px;
      padding:4px;
    }
    .seg button{
      border:0;border-radius:999px;
      padding:9px 12px;
      font-size:13px;
      background:transparent;
      color: rgba(18,18,18,.70);
      cursor:pointer;
    }
    .seg button.active{
      background: rgba(245,196,0,.90);
      color:#111;
      border:1px solid rgba(245,196,0,.95);
    }

    .btn{
      width:100%;
      border:0;
      border-radius: 18px;
      height: var(--btnH);
      padding:0 16px;
      cursor:pointer;
      font-weight:900;
      font-size:16px;
      background: var(--accent);
      color:#111;
      margin-top:14px;
      box-shadow: 0 12px 28px rgba(245,196,0,.28);
    }
    .btn:active{transform: translateY(1px)}

    .btn.secondary{
      background: var(--accentDark);
      color:#fff;
      border:1px solid rgba(26,26,26,.95);
      margin-top:10px;
      box-shadow:none;
    }
    .btn.ghost{
      background:#fff;
      border:1px solid rgba(18,18,18,.16);
      box-shadow:none;
    }

    .result{
      margin-top:14px;
      padding:16px;
      border-radius: 22px;
      background: linear-gradient(180deg, rgba(245,196,0,.14), rgba(245,196,0,.06));
      border:1px solid rgba(245,196,0,.45);
    }

    .priceTop{
      display:flex;align-items:baseline;justify-content:space-between;
      gap:10px;flex-wrap:wrap;
    }
    .priceLabel{font-size:14px;color:rgba(18,18,18,.70);font-weight:800}
    .priceValue{
      font-size:36px;
      line-height:1;
      font-weight:1000;
      letter-spacing:.2px;
      background: rgba(26,26,26,.92);
      color:#fff;
      padding:10px 14px;
      border-radius: 18px;
    }
    .note{margin:10px 0 0;color:rgba(18,18,18,.72);font-size:13px}

    .timebox{margin-top:12px;display:grid;grid-template-columns:1fr;gap:10px}
    .pill{
      padding:14px 14px;
      border-radius: 18px;
      border:1px solid rgba(18,18,18,.12);
      background:#fff;
      font-size:14px;
      color: rgba(18,18,18,.72);
    }
    .pill b{color:var(--text)}

    .ctaRow{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:14px}
    @media (max-width: 560px){ .ctaRow{grid-template-columns:1fr} }

    .hr{height:1px;background: rgba(18,18,18,.10);margin:16px 0}
    .small{font-size:12px;color: rgba(18,18,18,.60)}

    .contactGrid{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:12px}
    @media (max-width: 560px){ .contactGrid{grid-template-columns:1fr} }
    .contactBtn{
      display:flex;align-items:center;justify-content:center;
      height: var(--btnH);
      border-radius: 18px;
      text-decoration:none;
      font-weight:950;
      border:1px solid rgba(18,18,18,.16);
      background:#fff;
    }
    .contactBtn.dark{background: rgba(26,26,26,.92); color:#fff; border-color: rgba(26,26,26,.92)}
    .contactBtn.yellow{background: var(--accent); color:#111; border-color: rgba(245,196,0,.95)}

    /* Modal scroll fix */
    .modal{
      position:fixed;inset:0;display:none;
      background: rgba(0,0,0,.55);
      padding:16px;
      z-index:50;
      overflow:auto;
      -webkit-overflow-scrolling: touch;
    }
    .modal.open{display:block}
    .modalCard{
      max-width: 980px;
      margin: 2vh auto;
      background:#fff;
      border:1px solid rgba(18,18,18,.16);
      border-radius: 22px;
      box-shadow: 0 20px 70px rgba(0,0,0,.25);
      overflow:hidden;
      max-height: 92vh;
      display:flex;
      flex-direction:column;
    }
    .modalHeader{
      display:flex;justify-content:space-between;align-items:center;
      padding:14px 16px;
      border-bottom:1px solid rgba(18,18,18,.10);
      background: rgba(245,196,0,.22);
    }
    .modalHeader h3{margin:0;font-size:16px}
    .closeBtn{
      border:1px solid rgba(18,18,18,.16);
      background: rgba(26,26,26,.92);
      color:#fff;
      border-radius: 12px;
      padding:8px 10px;
      cursor:pointer;
      font-weight:950;
    }
    .modalBody{
      padding:14px 16px;
      overflow:auto;
      -webkit-overflow-scrolling: touch;
    }
    .gallery{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    @media (max-width: 860px){ .gallery{grid-template-columns:1fr} }
    .gItem{
      border:1px solid rgba(18,18,18,.12);
      border-radius: 16px;
      overflow:hidden;
      background:#fff;
    }
    .gItem .cap{
      padding:10px 12px;
      color: rgba(18,18,18,.70);
      font-size:13px;
      background: rgba(245,196,0,.10);
      border-bottom:1px solid rgba(18,18,18,.08);
    }
    .gItem img{width:100%;display:block;background:#fff}
    .gTitle{font-weight:950;color:var(--text);margin-right:8px}

    .stickyBar{
      position:fixed;left:0;right:0;bottom:0;
      padding:10px 12px;
      background: rgba(255,255,255,.92);
      border-top:1px solid rgba(18,18,18,.12);
      backdrop-filter: blur(10px);
      display:none;
      z-index:40;
    }
    .stickyBar .inner{max-width:1100px;margin:0 auto;display:grid;grid-template-columns:1fr 1fr;gap:10px}
    .stickyBar a{height:46px;border-radius:16px;font-weight:950}
    @media (max-width: 980px){ .stickyBar{display:block} body{padding-bottom:80px} }
  
    .modalBody .actions{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:10px;
      margin-top:12px;
    }
    @media (max-width: 560px){ .modalBody .actions{ grid-template-columns:1fr; } }

    .copyRow{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      justify-content:space-between;
      margin-top:10px;
    }
    .miniBtn{
      border:1px solid rgba(18,18,18,.16);
      background:#fff;
      color:#111;
      border-radius:14px;
      padding:10px 12px;
      font-weight:900;
      cursor:pointer;
    }
    .statusOk{
      display:inline-flex;
      gap:8px;
      align-items:center;
      padding:8px 10px;
      border-radius: 999px;
      background: rgba(245,196,0,.18);
      border:1px solid rgba(245,196,0,.45);
      font-size:12px;
      color: rgba(18,18,18,.78);
      font-weight:800;
    }
    .statusBad{
      display:inline-flex;
      gap:8px;
      align-items:center;
      padding:8px 10px;
      border-radius: 999px;
      background: rgba(26,26,26,.06);
      border:1px solid rgba(18,18,18,.18);
      font-size:12px;
      color: rgba(18,18,18,.78);
      font-weight:800;
    }
    .msgBox{
      width:100%;
      margin-top:12px;
      padding:12px 12px;
      border-radius: 18px;
      border: 1px solid rgba(18,18,18,.16);
      background: #fff;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size: 12.5px;
      line-height: 1.35;
      max-height: 42vh;
      overflow:auto;
      -webkit-overflow-scrolling: touch;
      white-space: pre-wrap;
    }

  
    #bookingModal .modalBody{
      max-height: 70vh;
      overflow-y:auto;
      -webkit-overflow-scrolling: touch;
    }

  </style>
</head>

<body>
  <div class="wrap">
    <section class="hero">
      <div class="badge">Toronto & GTA • Deep Cleaning • +30 min FREE</div>
      <h1>Deep Cleaning Price Calculator</h1>
      <p class="sub">Time-based estimate with a clear minimum. Minimum order is <b>$195</b> for <b>5 hours</b>, plus <b>30 minutes FREE</b> on top.</p>
      <div class="heroRow">
        <div class="heroPill">Minimum: <b>$195 / 5 hours</b></div>
        <div class="heroPill">Bonus: <b>+30 minutes FREE</b></div>
        <div class="heroPill">Area unit: <b>sq ft</b> (default)</div>
      </div>
    </section>

    <div class="grid">
      <section class="card" id="calculator">
        <h2>Estimate</h2>
        <div class="muted">Enter details and tap “Calculate”.</div>

        <div class="row">
          <div>
            <label>Bedrooms</label>
            <input id="bedrooms" type="number" min="0" value="1" />
          </div>
          <div>
            <label>Bathrooms</label>
            <input id="bathrooms" type="number" min="0" value="1" />
          </div>
        </div>

        <label>Kitchens</label>
        <input id="kitchens" type="number" min="0" value="1" />

        
<div class="row">
  <div>
    <label>Floors</label>
    <input id="floors" type="number" min="1" value="1" />
  </div>
  <div>
    <label>Dining rooms</label>
    <input id="diningRooms" type="number" min="0" value="0" />
  </div>
</div>

<label>Basement</label>
<input id="basements" type="number" min="0" value="0" />
<div class="unitbar">
          <div>
            <div style="font-weight:950">Area unit</div>
            <div class="muted" id="unitHint">Default: sq ft</div>
          </div>
          <div class="seg" role="tablist" aria-label="Area unit">
            <button id="unitSqft" class="active" type="button" aria-selected="true">sq ft</button>
            <button id="unitM2" type="button" aria-selected="false">m²</button>
          </div>
        </div>

        <label id="areaLabel">Total area (sq ft)</label>
        <input id="area" type="number" min="0" value="800" placeholder="e.g., 800" />

        <button class="btn" id="calcBtn" type="button">Calculate</button>
        <button class="btn secondary" id="includedBtn" type="button">What’s included in deep cleaning?</button>

        <div class="result" aria-live="polite">
          <div class="priceTop">
            <div class="priceLabel">Estimated price</div>
            <div class="priceValue" id="priceText">$—</div>
          </div>
          <div class="note" id="priceNote">Time-based estimate. Final price depends on condition and level of soiling.</div>

          <div class="timebox">
            <div class="pill" id="billableTime">Billable time: <b>—</b></div>
            <div class="pill" id="onsiteTime">On-site time: <b>—</b></div>
          </div>

          <div class="ctaRow">
            <a class="contactBtn dark" href="#booking">Get an exact quote</a>
            <a class="contactBtn" href="#pricing">How pricing works</a>
          </div>
        </div>

        <div class="small" style="margin-top:10px">
          * This is an estimate based on size and layout. Deep cleaning complexity can change the final time and price.
        </div>
      </section>

      <aside class="card" id="pricing">
        <h2>How pricing works</h2>
        <p class="muted" style="margin:0 0 10px">
          We estimate <b>billable time</b> from bedrooms, bathrooms, kitchens, floors, dining rooms, basement, and area. There is a <b>5-hour minimum</b>.
          On-site time always includes <b>+30 minutes FREE</b>. Minimum order price is <b>$195</b>.<br><span class="muted" style="font-size:12px">Maximum billable time is <b>10 hours</b> (+30 min FREE on-site).</span>
        </p>

        <div class="hr"></div>

        <h2 style="margin-top:0">Quick contact</h2>
        <div class="muted">Ask a question, clarify details, or book directly:</div>
        <div class="contactGrid">
          <a class="contactBtn yellow" href="https://ig.me/m/northstarclean17" target="_blank" rel="noopener">Write on Instagram</a>
          <a class="contactBtn dark" href="https://m.me/Northstarclean17" target="_blank" rel="noopener">Write on Facebook</a>
        </div>

        <div class="hr"></div>

        <div class="muted" style="margin-bottom:8px"><b>Minimum order</b></div>
        <div class="heroPill" style="display:inline-block;margin-bottom:8px">Starting at <b>$195 for 5 hours + 30 min. FREE</b></div>
        <div class="muted">To confirm your booking and choose the most convenient dates, we will give you a quick call. <b>No prepayment required.</b></div>
      </aside>
    </div>

    <section class="card" id="booking" style="margin-top:16px">
      <h2>Booking details</h2>
      <div class="muted">Fill in your details, tap “Copy booking message”, then send it to us on Instagram or Facebook. We’ll call you to confirm and pick the best date. No prepayment required.</div>

      <div class="row" style="margin-top:6px">
        <div>
          <label>Name</label>
          <input id="bName" placeholder="Name" />
        </div>
        <div>
          <label>Email</label>
          <input id="bEmail" type="email" placeholder="Email" />
        </div>
      </div>

      <label>Address</label>
      <input id="bAddress" placeholder="Address" />

      <div class="row">
        <div>
          <label>Phone</label>
          <input id="bPhone" type="tel" placeholder="Phone number" />
        </div>
        <div>
          <label>Preferred dates/times</label>
          <input id="bPreferred" placeholder="e.g., Sat 10–12 or Mon evening" />
        </div>
      </div>

      <div class="row">
        <div>
          <label>Pay Cash (Yes/No)</label>
          <select id="bCash">
            <option value="">Select</option>
            <option>Yes</option>
            <option>No</option>
          </select>
        </div>
        <div>
          <label>Pets</label>
          <select id="bPets">
            <option value="">Select</option>
            <option>No</option>
            <option>Yes</option>
          </select>
        </div>
      </div>

<label>Wishes &amp; additional notes</label>
      <textarea id="bNotes" placeholder="Any wishes, extra details, access instructions, parking, etc."></textarea>

      <div class="row">
        <button class="btn" id="bookBtn" type="button">Book now</button>
        <div class="small" style="display:flex;align-items:center;padding:10px 4px;color:rgba(18,18,18,.70)">
          After you send the message: we’ll call you to confirm the booking and choose the most convenient date/time. No prepayment required.
        </div>
      </div>

      <div class="contactGrid">
        <a class="contactBtn yellow" href="https://ig.me/m/northstarclean17" target="_blank" rel="noopener">Write on Instagram</a>
        <a class="contactBtn dark" href="https://m.me/Northstarclean17" target="_blank" rel="noopener">Write on Facebook</a>
      </div>

      <div class="small" id="copyStatus" style="margin-top:10px"></div>

      <div class="hr"></div>
      <div class="muted"><b>After you send the message:</b> we’ll call you to confirm the booking and choose the most convenient date/time. <b>No prepayment required.</b></div>
    </section>
  </div>

  <div class="modal" id="includedModal" role="dialog" aria-modal="true" aria-labelledby="includedTitle">
    <div class="modalCard">
      <div class="modalHeader">
        <h3 id="includedTitle">What’s included in deep cleaning</h3>
        <button class="closeBtn" id="closeModal" type="button">Close</button>
      </div>
      <div class="modalBody">
        <div class="muted" style="margin-bottom:12px">Scroll to view the full checklist images.</div>
        <div class="gallery">
          <div class="gItem">
            <div class="cap"><span class="gTitle">Bedrooms</span> deep cleaning tasks</div>
            <img src="assets/deep-cleaning-bedrooms.jpg" alt="Deep cleaning bedrooms tasks" loading="lazy" />
          </div>
          <div class="gItem">
            <div class="cap"><span class="gTitle">Kitchen</span> deep cleaning tasks</div>
            <img src="assets/deep-cleaning-kitchen.jpg" alt="Deep cleaning kitchen tasks" loading="lazy" />
          </div>
          <div class="gItem">
            <div class="cap"><span class="gTitle">Bathroom</span> deep cleaning tasks</div>
            <img src="assets/deep-cleaning-bathroom.jpg" alt="Deep cleaning bathroom tasks" loading="lazy" />
          </div>
          <div class="gItem">
            <div class="cap"><span class="gTitle">General spaces</span> deep cleaning tasks</div>
            <img src="assets/deep-cleaning-general-spaces.jpg" alt="Deep cleaning general spaces tasks" loading="lazy" />
          </div>
        </div>
        </div>
    </div>
  </div>

  <div class="stickyBar" aria-hidden="true">
    <div class="inner">
      <a class="contactBtn yellow" href="https://ig.me/m/northstarclean17" target="_blank" rel="noopener">Write on Instagram</a>
      <a class="contactBtn dark" href="https://m.me/Northstarclean17" target="_blank" rel="noopener">Write on Facebook</a>
    </div>
  </div>

  <script>
    const PRICING = {
      currency: "$",
      hourlyRate: 39,
      minBillableHours: 5.0,
            maxBillableHours: 10.0,   // cap billable time
      freeBonusHours: 0.5,
      minOrderPrice: 195,
      baseHours: 1.0,
      hoursPerBedroom: 0.25,
      hoursPerBathroom: 0.35,
      hoursPerKitchen: 0.40,
      hoursPerDiningRoom: 0.20,
      hoursPerBasement: 0.30,
      hoursPerExtraFloor: 0.20,
      hoursPer1000Sqft: 0.40,
      rangeMultiplierHigh: 1.15
    };

    let currentUnit = "sqft";

    const els = {
      bedrooms: document.getElementById("bedrooms"),
      bathrooms: document.getElementById("bathrooms"),
      kitchens: document.getElementById("kitchens"),
      floors: document.getElementById("floors"),
      diningRooms: document.getElementById("diningRooms"),
      basements: document.getElementById("basements"),
      area: document.getElementById("area"),
      areaLabel: document.getElementById("areaLabel"),
      unitSqft: document.getElementById("unitSqft"),
      unitM2: document.getElementById("unitM2"),
      unitHint: document.getElementById("unitHint"),
      calcBtn: document.getElementById("calcBtn"),
      includedBtn: document.getElementById("includedBtn"),
      includedModal: document.getElementById("includedModal"),
      closeModal: document.getElementById("closeModal"),
      priceText: document.getElementById("priceText"),
      priceNote: document.getElementById("priceNote"),
      billableTime: document.getElementById("billableTime"),
      onsiteTime: document.getElementById("onsiteTime"),

      bName: document.getElementById("bName"),
      bAddress: document.getElementById("bAddress"),
      bEmail: document.getElementById("bEmail"),
      bPhone: document.getElementById("bPhone"),
      bPreferred: document.getElementById("bPreferred"),
      bCash: document.getElementById("bCash"),
      bPets: document.getElementById("bPets"),bNotes: document.getElementById("bNotes"),
      copyStatus: document.getElementById("copyStatus"),
          bookBtn: document.getElementById("bookBtn"),
      bookingModal: document.getElementById("bookingModal"),
      closeBookingModal: document.getElementById("closeBookingModal"),
      copyAgainBtn: document.getElementById("copyAgainBtn"),
      bookingCopyStatus: document.getElementById("bookingCopyStatus"),
      bookingMsgBox: document.getElementById("bookingMsgBox"),
};

    const SQFT_PER_M2 = 10.76391041671;

    function clamp(n){ return (!Number.isFinite(n) || n < 0) ? 0 : n; }
    function roundUpHalf(n){ return Math.ceil(n * 2) / 2; }
    function areaToSqft(area, unit){ return unit === "m2" ? area * SQFT_PER_M2 : area; }

    function computeBillableHours({ bedrooms, bathrooms, kitchens, floors, diningRooms, basements, area, unit }){
  bedrooms = clamp(bedrooms);
  bathrooms = clamp(bathrooms);
  kitchens = clamp(kitchens);
  floors = clamp(floors);
  diningRooms = clamp(diningRooms);
  basements = clamp(basements);
  area = clamp(area);

  const areaSqft = areaToSqft(area, unit);
  const extraFloors = Math.max(0, floors - 1);

  let hours =
    PRICING.baseHours +
    bedrooms * PRICING.hoursPerBedroom +
    bathrooms * PRICING.hoursPerBathroom +
    kitchens * PRICING.hoursPerKitchen +
    diningRooms * PRICING.hoursPerDiningRoom +
    basements * PRICING.hoursPerBasement +
    extraFloors * PRICING.hoursPerExtraFloor +
    (areaSqft / 1000) * PRICING.hoursPer1000Sqft;

  hours = roundUpHalf(hours);
  let billable = Math.max(PRICING.minBillableHours, hours);
      billable = Math.min(PRICING.maxBillableHours, billable);
      return { billableHours: billable, areaSqft };
}


    function computePriceRange(billableHours){
      let base = billableHours * PRICING.hourlyRate;
      base = Math.max(base, PRICING.minOrderPrice);
      const low = Math.round(base);
      const high = Math.max(low, Math.round(base * PRICING.rangeMultiplierHigh));
      return { low, high };
    }

    function getInputs(){
  return {
    bedrooms: Number(els.bedrooms.value),
    bathrooms: Number(els.bathrooms.value),
    kitchens: Number(els.kitchens.value),
    floors: Number(els.floors.value),
    diningRooms: Number(els.diningRooms.value),
    basements: Number(els.basements.value),
    area: Number(els.area.value),
    unit: currentUnit
  };
}

function setUnit(unit){
      currentUnit = unit;

      if (unit === "sqft"){
        els.unitSqft.classList.add("active");
        els.unitM2.classList.remove("active");
        els.unitSqft.setAttribute("aria-selected", "true");
        els.unitM2.setAttribute("aria-selected", "false");
        els.areaLabel.textContent = "Total area (sq ft)";
        els.unitHint.textContent = "Default: sq ft";
      } else {
        els.unitM2.classList.add("active");
        els.unitSqft.classList.remove("active");
        els.unitM2.setAttribute("aria-selected", "true");
        els.unitSqft.setAttribute("aria-selected", "false");
        els.areaLabel.textContent = "Total area (m²)";
        els.unitHint.textContent = "Converted to sq ft for calculation";
      }
    }

    function renderEstimate(){
      const inputs = getInputs();

      if (!inputs.area || inputs.area <= 0){
        els.priceText.textContent = "$—";
        els.priceNote.textContent = "Enter a valid area to calculate.";
        els.billableTime.innerHTML = 'Billable time: <b>—</b>';
        els.onsiteTime.innerHTML = 'On-site time: <b>—</b>';
        return;
      }

      const { billableHours } = computeBillableHours(inputs);
      const onsiteHours = billableHours + PRICING.freeBonusHours;
      const { low, high } = computePriceRange(billableHours);

      els.priceText.textContent = `${PRICING.currency}${low}–${PRICING.currency}${high}`;
      els.priceNote.textContent = "Time-based estimate. Final price depends on condition and level of soiling.";

      
      if (billableHours >= PRICING.maxBillableHours) {
        els.priceNote.textContent = "Time-based estimate. Capped at 10 billable hours (+30 min FREE). Final price depends on condition and level of soiling.";
      }
els.billableTime.innerHTML = `Billable time: <b>${billableHours.toFixed(1)} hrs</b>`;
      els.onsiteTime.innerHTML = `On-site time: <b>${onsiteHours.toFixed(1)} hrs</b> (+30 min FREE)`;
    }

    els.unitSqft.addEventListener("click", () => { 
    setUnit("sqft"); renderEstimate(); });
    els.unitM2.addEventListener("click", () => { setUnit("m2"); renderEstimate(); });
    els.calcBtn.addEventListener("click", renderEstimate);

    function openModal(){
      els.includedModal.classList.add("open");
      document.body.style.overflow = "hidden";
    }
    function closeModal(){
      els.includedModal.classList.remove("open");
      document.body.style.overflow = "";
    }
    els.includedBtn.addEventListener("click", openModal);
    els.closeModal.addEventListener("click", closeModal);
    els.includedModal.addEventListener("click", (e) => {
      if (e.target === els.includedModal) closeModal();
    });
    function fmtDateTime(v){
      if (!v) return "";
      try {
        const d = new Date(v);
        if (isNaN(d.getTime())) return v;
        return d.toLocaleString();
      } catch(e) {
        return v;
      }
    }

            function buildBookingMessage(){
      const name = (els.bName.value || "").trim();
      const phone = (els.bPhone.value || "").trim();
      const address = (els.bAddress.value || "").trim();
      const email = (els.bEmail.value || "").trim();
      const preferred = (els.bPreferred.value || "").trim();
      const cash = (els.bCash.value || "").trim();
      const pets = (els.bPets.value || "").trim();
      const notes = (els.bNotes.value || "").trim();

      // Include calculator details (layout + estimated price + hours)
      const inputs = getInputs();
      let estimateBlock = "";

      if (inputs.area && inputs.area > 0) {
        const { billableHours, areaSqft } = computeBillableHours(inputs);
        const onsiteHours = billableHours + PRICING.freeBonusHours;
        const { low, high } = computePriceRange(billableHours);

        const areaLine = inputs.unit === "m2"
          ? `${inputs.area} m² (≈ ${Math.round(areaSqft)} sq ft)`
          : `${inputs.area} sq ft`;

        estimateBlock =
`--- Estimate from calculator ---
Bedrooms: ${inputs.bedrooms}
Bathrooms: ${inputs.bathrooms}
Kitchens: ${inputs.kitchens}
Floors: ${inputs.floors}
Dining rooms: ${inputs.diningRooms}
Basement: ${inputs.basements}
Area: ${areaLine}
Estimated price: ${PRICING.currency}${low}–${PRICING.currency}${high}
Billable time: ${billableHours.toFixed(1)} hrs
On-site time: ${onsiteHours.toFixed(1)} hrs (+30 min FREE)

`;
      } else {
        estimateBlock =
`--- Estimate from calculator ---
(Please enter the area and tap "Calculate" first)

`;
      }

      return `Hi! I'd like to book a Deep Cleaning.

${estimateBlock}` +
        `Name: ${name}
` +
        `Phone: ${phone}
` +
        `Address: ${address}
` +
        `Email: ${email}
` +
        `Preferred dates/times: ${preferred}
` +
        `Pay Cash (Yes/No): ${cash}
` +
        `Pets: ${pets}
` +
        `Wishes & additional notes: ${notes}

` +
        `Thank you!`;
    }


    async function copyToClipboard(text){
  try {
    await navigator.clipboard.writeText(text);
    return true;
  } catch (e) {
    const ta = document.createElement("textarea");
    ta.value = text;
    ta.style.position = "fixed";
    ta.style.left = "-9999px";
    ta.style.top = "0";
    document.body.appendChild(ta);
    ta.focus();
    ta.select();
    let ok = false;
    try {
      ok = document.execCommand("copy");
    } catch(e2) {
      ok = false;
    }
    document.body.removeChild(ta);
    return ok;
  }
}

function openBookingModal(message, copiedOk){
  els.bookingMsgBox.value = message;
  els.bookingCopyStatus.className = copiedOk ? "statusOk" : "statusBad";
  els.bookingCopyStatus.textContent = copiedOk
    ? "✅ Message copied to clipboard"
    : "⚠️ Could not copy automatically. Use 'Copy again' or copy from the box below.";

  els.bookingModal.classList.add("open");
  document.body.style.overflow = "hidden";
  try { els.bookingMsgBox.scrollTop = 0; } catch(e){}
}

function closeBookingModal(){
  els.bookingModal.classList.remove("open");
  document.body.style.overflow = "";
}

// Close booking modal
els.closeBookingModal.addEventListener("click", closeBookingModal);
els.bookingModal.addEventListener("click", (e) => {
  if (e.target === els.bookingModal) closeBookingModal();
});

// Copy again button (works even when clipboard is blocked)
els.copyAgainBtn.addEventListener("click", async () => {
  const msg = els.bookingMsgBox.value || "";
  const ok = await copyToClipboard(msg);
  els.bookingCopyStatus.className = ok ? "statusOk" : "statusBad";
  els.bookingCopyStatus.textContent = ok
    ? "✅ Message copied to clipboard"
    : "⚠️ Could not copy automatically. Please select and copy the text manually.";

  if (!ok){
    // Fallback that often works on mobile in-app browsers
    try { window.prompt("Copy this booking message:", msg); } catch(e){}
  }
});

// BOOK: copy + open modal (so the user definitely sees the next step)
els.bookBtn.addEventListener("click", async () => {
  const msg = buildBookingMessage();
  const ok = await copyToClipboard(msg);

  if (els.copyStatus) {
    els.copyStatus.textContent = ok
      ? "Copied. Now send the message via Instagram/Facebook."
      : "Could not copy automatically. Please copy manually in the next step.";
  }

  openBookingModal(msg, ok);
});

// ESC closes both modals
document.addEventListener("keydown", (e) => {
  if (e.key === "Escape") {
    try { closeModal(); } catch(e1){}
    try { closeBookingModal(); } catch(e2){}
  }
});

setUnit("sqft");
    renderEstimate();
  </script>

  <div class="modal" id="bookingModal" role="dialog" aria-modal="true" aria-labelledby="bookingTitle">
    <div class="modalCard">
      <div class="modalHeader">
        <h3 id="bookingTitle">Final step: send your booking message</h3>
        <button class="closeBtn" id="closeBookingModal" type="button">Close</button>
      </div>
      <div class="modalBody">
        <div class="muted" style="margin-bottom:10px">
          To finalize the booking, please send the copied message to us on Instagram or Facebook.
        </div>

        <div class="copyRow">
          <div id="bookingCopyStatus" class="statusOk">✅ Message copied to clipboard</div>
          <button class="miniBtn" id="copyAgainBtn" type="button">Copy again</button>
        </div>

        <div class="actions">
          <a class="contactBtn yellow" href="https://ig.me/m/northstarclean17" target="_blank" rel="noopener">Write on Instagram</a>
          <a class="contactBtn dark" href="https://m.me/Northstarclean17" target="_blank" rel="noopener">Write on Facebook</a>
        </div>

        <div class="small" style="margin-top:10px">
          Tip: After opening the chat, tap and hold the message box, then choose <b>Paste</b>.
        </div>

        <textarea class="msgBox" id="bookingMsgBox" readonly></textarea>
      </div>
    </div>
  </div>

</body>
</html>

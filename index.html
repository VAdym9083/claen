<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<title>Deep Cleaning Price Calculator</title>
<script type="text/javascript">
    (function(c,l,a,r,i,t,y){
        c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
        t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
        y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
    })(window, document, "clarity", "script", "vj9i1sfm9b");
  </script>
<style>
    :root{
      --bg:#f5f7fb;
      --card:#ffffff;
      --text:#121212;
      --muted:#5c636b;
      --border:rgba(18,18,18,.12);

      --accent:#f5c400;
      --accent2:#ffdf6a;
      --accentDark:#1a1a1a;
      --shadow: 0 18px 55px rgba(0,0,0,.10);
      --radius:20px;
      --btnH:56px;
    }

    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background:
        radial-gradient(900px 520px at 25% 0%, rgba(245,196,0,.22), transparent 60%),
        radial-gradient(760px 520px at 85% 10%, rgba(26,26,26,.10), transparent 55%),
        var(--bg);
      color:var(--text);
    }
    a{color:inherit}
    .wrap{max-width:1100px;margin:0 auto;padding:24px}
    .hero{
      background: linear-gradient(180deg, rgba(245,196,0,.26), rgba(245,196,0,.08));
      border:1px solid rgba(245,196,0,.55);
      border-radius: var(--radius);
      padding:22px;
      box-shadow: var(--shadow);
      position:relative;
      overflow:hidden;
    }
    .hero:after{
      content:"";
      position:absolute;right:-120px;top:-140px;
      width:340px;height:340px;border-radius:50%;
      background: rgba(26,26,26,.08);
    }
    .badge{
      display:inline-flex;gap:8px;align-items:center;
      padding:7px 12px;border-radius:999px;
      background: rgba(26,26,26,.92);
      border:1px solid rgba(26,26,26,.92);
      color:#fff;
      font-size:12px;
      letter-spacing:.2px;
    }
    h1{margin:10px 0 6px;font-size:30px;line-height:1.1}
    .sub{margin:0;color:rgba(18,18,18,.78);max-width:860px}
    .heroRow{display:flex;gap:12px;flex-wrap:wrap;margin-top:14px}
    .heroPill{
      padding:10px 12px;border-radius:16px;
      background: rgba(255,255,255,.85);
      border:1px solid rgba(18,18,18,.10);
      font-weight:800;
      font-size:14px;
    }
    .heroPill b{color:var(--accentDark)}

    .grid{
      display:grid;
      grid-template-columns: 1.05fr .95fr;
      gap:16px;
      margin-top:16px;
      align-items:start;
    }
    @media (max-width: 980px){ .grid{grid-template-columns:1fr} }

    .card{
      background: var(--card);
      border:1px solid var(--border);
      border-radius: var(--radius);
      padding:18px;
      box-shadow: var(--shadow);
    }
    .card h2{margin:0 0 6px;font-size:18px}
    .muted{color:var(--muted);font-size:13px}

    label{display:block;margin:12px 0 6px;font-size:14px;color: rgba(18,18,18,.88)}
    input, textarea, select{
      width:100%;
      padding:12px 12px;
      border-radius: 16px;
      border: 1px solid var(--border);
      background:#fff;
      color:var(--text);
      font-size:15px;
      outline:none;
    }
    textarea{resize:vertical;min-height:104px}
    input::placeholder, textarea::placeholder{color: rgba(18,18,18,.45)}

    .row{display:grid;grid-template-columns: 1fr 1fr;gap:12px}
    @media (max-width: 560px){ .row{grid-template-columns:1fr} }

    .unitbar{
      display:flex;gap:10px;align-items:center;justify-content:space-between;
      padding:10px 12px;border-radius: 16px;
      border:1px solid var(--border);
      background: rgba(245,247,251,.95);
      margin-top:10px;
    }
    .seg{
      display:flex;gap:6px;align-items:center;
      border:1px solid var(--border);
      background:#fff;
      border-radius:999px;
      padding:4px;
    }
    .seg button{
      border:0;border-radius:999px;
      padding:9px 12px;
      font-size:13px;
      background:transparent;
      color: rgba(18,18,18,.70);
      cursor:pointer;
    }
    .seg button.active{
      background: rgba(245,196,0,.90);
      color:#111;
      border:1px solid rgba(245,196,0,.95);
    }

    .btn{
      width:100%;
      border:0;
      border-radius: 18px;
      height: var(--btnH);
      padding:0 16px;
      cursor:pointer;
      font-weight:900;
      font-size:16px;
      background: var(--accent);
      color:#111;
      margin-top:14px;
      box-shadow: 0 12px 28px rgba(245,196,0,.28);
    }
    .btn:active{transform: translateY(1px)}

    .btn.secondary{
      background: var(--accentDark);
      color:#fff;
      border:1px solid rgba(26,26,26,.95);
      margin-top:10px;
      box-shadow:none;
    }
    .btn.ghost{
      background:#fff;
      border:1px solid rgba(18,18,18,.16);
      box-shadow:none;
    }

    .result{
      margin-top:14px;
      padding:16px;
      border-radius: 22px;
      background: linear-gradient(180deg, rgba(245,196,0,.14), rgba(245,196,0,.06));
      border:1px solid rgba(245,196,0,.45);
    }

    .priceTop{
      display:flex;align-items:baseline;justify-content:space-between;
      gap:10px;flex-wrap:wrap;
    }
    .priceLabel{font-size:14px;color:rgba(18,18,18,.70);font-weight:800}
    .priceValue{
      font-size:36px;
      line-height:1;
      font-weight:1000;
      letter-spacing:.2px;
      background: rgba(26,26,26,.92);
      color:#fff;
      padding:10px 14px;
      border-radius: 18px;
    }
    .note{margin:10px 0 0;color:rgba(18,18,18,.72);font-size:13px}

    .timebox{margin-top:12px;display:grid;grid-template-columns:1fr;gap:10px}
    .pill{
      padding:14px 14px;
      border-radius: 18px;
      border:1px solid rgba(18,18,18,.12);
      background:#fff;
      font-size:14px;
      color: rgba(18,18,18,.72);
    }
    .pill b{color:var(--text)}

    .ctaRow{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:14px}
    @media (max-width: 560px){ .ctaRow{grid-template-columns:1fr} }

    .hr{height:1px;background: rgba(18,18,18,.10);margin:16px 0}
    .small{font-size:12px;color: rgba(18,18,18,.60)}

    .contactGrid{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:12px}
    @media (max-width: 560px){ .contactGrid{grid-template-columns:1fr} }
    .contactBtn{
      display:flex;align-items:center;justify-content:center;
      height: var(--btnH);
      border-radius: 18px;
      text-decoration:none;
      font-weight:950;
      border:1px solid rgba(18,18,18,.16);
      background:#fff;
    }
    .contactBtn.dark{background: rgba(26,26,26,.92); color:#fff; border-color: rgba(26,26,26,.92)}
    .contactBtn.yellow{background: var(--accent); color:#111; border-color: rgba(245,196,0,.95)}

    /* Modal scroll fix */
    .modal{
      position:fixed;inset:0;display:none;
      background: rgba(0,0,0,.55);
      padding:16px;
      z-index:50;
      overflow:auto;
      -webkit-overflow-scrolling: touch;
    }
    .modal.open{display:block}
    .modalCard{
      max-width: 980px;
      margin: 2vh auto;
      background:#fff;
      border:1px solid rgba(18,18,18,.16);
      border-radius: 22px;
      box-shadow: 0 20px 70px rgba(0,0,0,.25);
      overflow:hidden;
      max-height: 92vh;
      display:flex;
      flex-direction:column;
    }
    .modalHeader{
      display:flex;justify-content:space-between;align-items:center;
      padding:14px 16px;
      border-bottom:1px solid rgba(18,18,18,.10);
      background: rgba(245,196,0,.22);
    }
    .modalHeader h3{margin:0;font-size:16px}
    .closeBtn{
      border:1px solid rgba(18,18,18,.16);
      background: rgba(26,26,26,.92);
      color:#fff;
      border-radius: 12px;
      padding:8px 10px;
      cursor:pointer;
      font-weight:950;
    }
    .modalBody{
      padding:14px 16px;
      overflow:auto;
      -webkit-overflow-scrolling: touch;
    }
    .gallery{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    @media (max-width: 860px){ .gallery{grid-template-columns:1fr} }
    .gItem{
      border:1px solid rgba(18,18,18,.12);
      border-radius: 16px;
      overflow:hidden;
      background:#fff;
    }
    .gItem .cap{
      padding:10px 12px;
      color: rgba(18,18,18,.70);
      font-size:13px;
      background: rgba(245,196,0,.10);
      border-bottom:1px solid rgba(18,18,18,.08);
    }
    .gItem img{width:100%;display:block;background:#fff}
    .gTitle{font-weight:950;color:var(--text);margin-right:8px}

    .stickyBar{
      position:fixed;left:0;right:0;bottom:0;
      padding:10px 12px;
      background: rgba(255,255,255,.92);
      border-top:1px solid rgba(18,18,18,.12);
      backdrop-filter: blur(10px);
      display:none;
      z-index:40;
    }
    .stickyBar .inner{max-width:1100px;margin:0 auto;display:grid;grid-template-columns:1fr 1fr;gap:10px}
    .stickyBar a{height:46px;border-radius:16px;font-weight:950}
    @media (max-width: 980px){ .stickyBar{display:block} body{padding-bottom:80px} }
  
    .modalBody .actions{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:10px;
      margin-top:12px;
    }
    @media (max-width: 560px){ .modalBody .actions{ grid-template-columns:1fr; } }

    .copyRow{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      justify-content:space-between;
      margin-top:10px;
    }
    .miniBtn{
      border:1px solid rgba(18,18,18,.16);
      background:#fff;
      color:#111;
      border-radius:14px;
      padding:10px 12px;
      font-weight:900;
      cursor:pointer;
    }
    .statusOk{
      display:inline-flex;
      gap:8px;
      align-items:center;
      padding:8px 10px;
      border-radius: 999px;
      background: rgba(245,196,0,.18);
      border:1px solid rgba(245,196,0,.45);
      font-size:12px;
      color: rgba(18,18,18,.78);
      font-weight:800;
    }
    .statusBad{
      display:inline-flex;
      gap:8px;
      align-items:center;
      padding:8px 10px;
      border-radius: 999px;
      background: rgba(26,26,26,.06);
      border:1px solid rgba(18,18,18,.18);
      font-size:12px;
      color: rgba(18,18,18,.78);
      font-weight:800;
    }
    .msgBox{
      width:100%;
      margin-top:12px;
      padding:12px 12px;
      border-radius: 18px;
      border: 1px solid rgba(18,18,18,.16);
      background: #fff;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size: 12.5px;
      line-height: 1.35;
      max-height: 42vh;
      overflow:auto;
      -webkit-overflow-scrolling: touch;
      white-space: pre-wrap;
    }

  
    #bookingModal .modalBody{
      max-height: 70vh;
      overflow-y:auto;
      -webkit-overflow-scrolling: touch;
    }

  </style>
</head>
<body>
<div class="wrap">
<section class="hero">
<div class="badge">Toronto &amp; GTA • Deep Cleaning • +30 min FREE</div>
<h1>Deep Cleaning Price Calculator</h1>
<p class="sub">Time-based estimate with a clear minimum. Minimum order is <b>$195</b> for <b>5 hours</b>, plus <b>30 minutes FREE</b> on top.</p>
<div class="heroRow">
<div class="heroPill">Minimum: <b>$195 / 5 hours</b></div>
<div class="heroPill">Bonus: <b>+30 minutes FREE</b></div>
<div class="heroPill">Area unit: <b>sq ft</b> (default)</div>
</div>
</section>
<div class="grid">
<section class="card" id="calculator">
<h2>Estimate</h2>
<div class="muted">Enter details and tap “Calculate”.</div>
<div class="row">
<div>
<label>Bedrooms</label>
<input id="bedrooms" min="0" type="number" value="1"/>
</div>
<div>
<label>Bathrooms</label>
<input id="bathrooms" min="0" type="number" value="1"/>
</div>
</div>
<label>Kitchens</label>
<input id="kitchens" min="0" type="number" value="1"/>
<div class="row">
<div>
<label>Floors</label>
<input id="floors" min="1" type="number" value="1"/>
</div>
<div>
<label>Dining rooms</label>
<input id="diningRooms" min="0" type="number" value="0"/>
</div>
</div>
<label>Basement</label>
<input id="basements" min="0" type="number" value="0"/>
<div class="unitbar">
<div>
<div style="font-weight:950">Area unit</div>
<div class="muted" id="unitHint">Default: sq ft</div>
</div>
<div aria-label="Area unit" class="seg" role="tablist">
<button aria-selected="true" class="active" id="unitSqft" type="button">sq ft</button>
<button aria-selected="false" id="unitM2" type="button">m²</button>
</div>
</div>
<label id="areaLabel">Total area (sq ft)</label>
<input id="area" min="0" placeholder="e.g., 800" type="number" value="800"/>
<button class="btn" id="calcBtn" type="button">Calculate</button>
<button class="btn secondary" id="includedBtn" type="button">What’s included in deep cleaning?</button>
<div aria-live="polite" class="result">
<div class="priceTop">
<div class="priceLabel">Estimated price</div>
<div class="priceValue" id="priceText">$—</div>
</div>
<div class="note" id="priceNote">Time-based estimate. Final price depends on condition and level of soiling.</div>
<div class="timebox">
<div class="pill" id="billableTime">Billable time: <b>—</b></div>
<div class="pill" id="onsiteTime">On-site time: <b>—</b></div>
</div>
<div class="ctaRow">


</div>
</div>
<div class="small" style="margin-top:10px">
          * This is an estimate based on size and layout. Deep cleaning complexity can change the final time and price.
        </div>
</section>
<aside class="card" id="pricing">
<h2>How pricing works</h2>
<p class="muted" style="margin:0 0 10px">
          We estimate <b>billable time</b> from bedrooms, bathrooms, kitchens, floors, dining rooms, basement, and area. There is a <b>5-hour minimum</b>.
          On-site time always includes <b>+30 minutes FREE</b>. Minimum order price is <b>$195</b>.<br/><span class="muted" style="font-size:12px">Maximum billable time is <b>10 hours</b> (+30 min FREE on-site).</span>
</p>
<div class="hr"></div>
<div class="muted" style="margin-bottom:8px"><b>Minimum order</b></div>
<div class="heroPill" style="display:inline-block;margin-bottom:8px">Starting at <b>$195 for 5 hours + 30 min. FREE</b></div>
<div class="muted">To confirm your booking and choose the most convenient dates, we will give you a quick call. <b>No prepayment required.</b></div>
</aside>
</div>
<section class="card" id="booking" style="margin-top:16px">
<h2>Booking details</h2>
<div class="muted">Fill in your details, tap “Copy booking message”, then send it to us on Instagram or Facebook. We’ll call you to confirm and pick the best date. No prepayment required.</div>
<div class="row" style="margin-top:6px">
<div>
<label>Name</label>
<input id="bName" placeholder="Name"/>
</div>
<div>
<label>Email</label>
<input id="bEmail" placeholder="Email" type="email"/>
</div>
</div>
<label>Address</label>
<input id="bAddress" placeholder="Address"/>
<div class="row">
<div>
<label>Phone</label>
<input id="bPhone" placeholder="Phone number" type="tel"/>
</div>
<div>
<label>Preferred dates/times</label>
<input id="bPreferred" placeholder="e.g., Sat 10–12 or Mon evening"/>
</div>
</div>
<div class="row">
<div>
<label>Pay Cash (Yes/No)</label>
<select id="bCash">
<option value="">Select</option>
<option>Yes</option>
<option>No</option>
</select>
</div>
<div>
<label>Pets</label>
<select id="bPets">
<option value="">Select</option>
<option>No</option>
<option>Yes</option>
</select>
</div>
</div>
<label>Wishes &amp; additional notes</label>
<textarea id="bNotes" placeholder="Any wishes, extra details, access instructions, parking, etc."></textarea>
<div class="row">
<button class="btn" id="bookBtn" type="button">Book now</button>
<div class="small" style="display:flex;align-items:center;padding:10px 4px;color:rgba(18,18,18,.70)">
          After you send the message: we’ll call you to confirm the booking and choose the most convenient date/time. No prepayment required.
        </div>
</div>
<div class="contactGrid">


</div>
<div class="small" id="copyStatus" style="margin-top:10px"></div>
<div class="hr"></div>
<div class="muted"><b>After you send the message:</b> we’ll call you to confirm the booking and choose the most convenient date/time. <b>No prepayment required.</b></div>
</section>
</div>
<div aria-labelledby="includedTitle" aria-modal="true" class="modal" id="includedModal" role="dialog">
<div class="modalCard">
<div class="modalHeader">
<h3 id="includedTitle">What’s included in deep cleaning</h3>
<button class="closeBtn" id="closeModal" type="button">Close</button>
</div>
<div class="modalBody">
<div class="muted" style="margin-bottom:12px">Scroll to view the full checklist images.</div>
<div class="gallery">
<div class="gItem">
<div class="cap"><span class="gTitle">Bedrooms</span> deep cleaning tasks</div>
<img alt="Deep cleaning bedrooms tasks" loading="lazy" src="assets/deep-cleaning-bedrooms.jpg"/>
</div>
<div class="gItem">
<div class="cap"><span class="gTitle">Kitchen</span> deep cleaning tasks</div>
<img alt="Deep cleaning kitchen tasks" loading="lazy" src="assets/deep-cleaning-kitchen.jpg"/>
</div>
<div class="gItem">
<div class="cap"><span class="gTitle">Bathroom</span> deep cleaning tasks</div>
<img alt="Deep cleaning bathroom tasks" loading="lazy" src="assets/deep-cleaning-bathroom.jpg"/>
</div>
<div class="gItem">
<div class="cap"><span class="gTitle">General spaces</span> deep cleaning tasks</div>
<img alt="Deep cleaning general spaces tasks" loading="lazy" src="assets/deep-cleaning-general-spaces.jpg"/>
</div>
</div>
</div>
</div>
</div>
<div aria-hidden="true" class="stickyBar">
<div class="inner">


</div>
</div>
<script>
(() => {
  "use strict";

  const PRICING = {
    hourlyRate: 39,
    minBillableHours: 5,
    maxBillableHours: 10,
    freeMinutes: 30,
    minOrderPrice: 195,
    highMultiplier: 1.15
  };

  const TIME = {
    base: 1.0,
    perBedroom: 0.25,
    perBathroom: 0.35,
    perKitchen: 0.40,
    perExtraFloor: 0.20,  // floors beyond the first
    perDining: 0.20,
    perBasement: 0.30,
    per1000Sqft: 0.40
  };

  const els = {
    // calculator inputs
    bedrooms: document.getElementById("bedrooms"),
    bathrooms: document.getElementById("bathrooms"),
    kitchens: document.getElementById("kitchens"),
    floors: document.getElementById("floors"),
    dining: document.getElementById("diningRooms"),
    basement: document.getElementById("basement"),
    area: document.getElementById("area"),
    unitSqftBtn: document.getElementById("unitSqft"),
    unitM2Btn: document.getElementById("unitM2"),
    unitHint: document.getElementById("unitHint"),
    areaLabel: document.getElementById("areaLabel"),

    // outputs
    priceText: document.getElementById("priceText"),
    priceNote: document.getElementById("priceNote"),
    billableTime: document.getElementById("billableTime"),
    onsiteTime: document.getElementById("onsiteTime"),

    // actions
    calcBtn: document.getElementById("calcBtn"),
    bookBtn: document.getElementById("bookBtn"),

    // "what's included" modal
    includedBtn: document.getElementById("includedBtn"),
    includedModal: document.getElementById("includedModal"),
    closeModal: document.getElementById("closeModal"),

    // booking modal
    bookingModal: document.getElementById("bookingModal"),
    closeBookingModal: document.getElementById("closeBookingModal"),
    bookingMsgBox: document.getElementById("bookingMsgBox"),
    bookingCopyStatus: document.getElementById("bookingCopyStatus"),
    copyAgainBtn: document.getElementById("copyAgainBtn"),
    igDmBtn: document.getElementById("igDmBtn"),
    fbDmBtn: document.getElementById("fbDmBtn"),

    // booking form fields
    bName: document.getElementById("bName"),
    bPhone: document.getElementById("bPhone"),
    bAddress: document.getElementById("bAddress"),
    bEmail: document.getElementById("bEmail"),
    bDateTime: document.getElementById("bDateTime"),
    bPayCash: document.getElementById("bPayCash"),
    bPets: document.getElementById("bPets"),
    bNotes: document.getElementById("bNotes"),
  };

  // -------- Unit handling --------
  let currentUnit = null; // will be set on init

  const SQFT_PER_M2 = 10.763910416709722;

  function toNumber(el, fallback = 0) {
    const v = Number(el?.value);
    return Number.isFinite(v) ? v : fallback;
  }

  function clamp(n, min, max) {
    return Math.max(min, Math.min(max, n));
  }

  function sqftToM2(sqft) {
    return sqft / SQFT_PER_M2;
  }
  function m2ToSqft(m2) {
    return m2 * SQFT_PER_M2;
  }

  function setUnit(unit) {
    if (unit !== "sqft" && unit !== "m2") return;
    if (unit === currentUnit) return;

    // convert the current input value so the number remains "same size"
    const raw = parseFloat(String(els.area.value || "").replace(",", "."));
    if (Number.isFinite(raw) && raw > 0) {
      const converted = unit === "m2" ? sqftToM2(raw) : m2ToSqft(raw);
      els.area.value = (Math.round(converted * 10) / 10).toString(); // 1 decimal max
    }

    currentUnit = unit;

    els.unitSqftBtn.classList.toggle("active", unit === "sqft");
    els.unitM2Btn.classList.toggle("active", unit === "m2");
    els.unitSqftBtn.setAttribute("aria-selected", unit === "sqft" ? "true" : "false");
    els.unitM2Btn.setAttribute("aria-selected", unit === "m2" ? "true" : "false");

    if (els.areaLabel) {
      els.areaLabel.textContent = unit === "sqft" ? "Area (sq ft)" : "Area (m²)";
    }
    if (els.unitHint) {
      els.unitHint.textContent = unit === "sqft" ? "sq ft" : "m²";
    }
  }

  function getAreaSqft() {
    const raw = parseFloat(String(els.area.value || "").replace(",", "."));
    if (!Number.isFinite(raw) || raw <= 0) return 0;
    return currentUnit === "m2" ? m2ToSqft(raw) : raw;
  }

  // -------- Estimate logic --------
  function estimateBillableHours({ bedrooms, bathrooms, kitchens, floors, diningRooms, basement, areaSqft }) {
    const extraFloors = Math.max(0, floors - 1);
    let hours =
      TIME.base +
      bedrooms * TIME.perBedroom +
      bathrooms * TIME.perBathroom +
      kitchens * TIME.perKitchen +
      extraFloors * TIME.perExtraFloor +
      diningRooms * TIME.perDining +
      basement * TIME.perBasement +
      (areaSqft / 1000) * TIME.per1000Sqft;

    // minimum & cap
    hours = clamp(hours, PRICING.minBillableHours, PRICING.maxBillableHours);

    // always round to nearest 0.5 for a cleaner UX
    hours = Math.round(hours * 2) / 2;

    // still respect cap after rounding
    hours = Math.min(hours, PRICING.maxBillableHours);

    return hours;
  }

  function calcPriceRange(billableHours) {
    const rawLow = Math.max(PRICING.minOrderPrice, billableHours * PRICING.hourlyRate);
    const low = Math.round(rawLow);
    const high = Math.floor(rawLow * PRICING.highMultiplier);
    return { low, high, rawLow };
  }

  function setPillText(pillEl, text) {
    if (!pillEl) return;
    const b = pillEl.querySelector("b");
    if (b) b.textContent = text;
  }

  function renderEstimate() {
    const bedrooms = toNumber(els.bedrooms, 0);
    const bathrooms = toNumber(els.bathrooms, 0);
    const kitchens = toNumber(els.kitchens, 0);
    const floors = toNumber(els.floors, 1);
    const diningRooms = toNumber(els.dining, 0);
    const basement = toNumber(els.basement, 0);
    const areaSqft = getAreaSqft();

    if (!areaSqft) {
      els.priceText.textContent = "—";
      els.priceNote.textContent = "Enter the area to get an estimate.";
      setPillText(els.billableTime, "—");
      setPillText(els.onsiteTime, "—");
      return null;
    }

    const billable = estimateBillableHours({ bedrooms, bathrooms, kitchens, floors, diningRooms, basement, areaSqft });
    const onsite = billable + PRICING.freeMinutes / 60;

    const { low, high } = calcPriceRange(billable);

    els.priceText.textContent = `$${low}–$${high}`;
    els.priceNote.textContent =
      "Time-based estimate. Final price depends on condition and level of soiling.";

    setPillText(els.billableTime, `${billable.toFixed(1)} hrs`);
    setPillText(els.onsiteTime, `${onsite.toFixed(1)} hrs (+30 min FREE)`);

    return {
      bedrooms, bathrooms, kitchens, floors, diningRooms, basement,
      areaSqft,
      areaDisplay: parseFloat(String(els.area.value || "").replace(",", ".")) || 0,
      unit: currentUnit,
      billable, onsite,
      low, high
    };
  }

  // -------- Booking message --------
  function buildBookingMessage(est) {
    const areaLine = est.unit === "m2"
      ? `${est.areaDisplay} m²`
      : `${Math.round(est.areaDisplay)} sq ft`;

    return [
      "Hi! I'd like to book a Deep Cleaning.",
      "",
      "--- Estimate from calculator ---",
      `Bedrooms: ${est.bedrooms}`,
      `Bathrooms: ${est.bathrooms}`,
      `Kitchens: ${est.kitchens}`,
      `Floors: ${est.floors}`,
      `Dining rooms: ${est.diningRooms}`,
      `Basement: ${est.basement}`,
      `Area: ${areaLine}`,
      `Estimated price: $${est.low}–$${est.high}`,
      `Billable time: ${est.billable.toFixed(1)} hrs`,
      `On-site time: ${est.onsite.toFixed(1)} hrs (+30 min FREE)`,
      "",
      `Name: ${els.bName.value || ""}`,
      `Phone: ${els.bPhone.value || ""}`,
      `Address: ${els.bAddress.value || ""}`,
      `Email: ${els.bEmail.value || ""}`,
      `Preferred dates/times: ${els.bDateTime.value || ""}`,
      `Pay Cash (Yes/No): ${els.bPayCash.value || ""}`,
      `Pets: ${els.bPets.value || ""}`,
      `Wishes & additional notes: ${els.bNotes.value || ""}`,
      "",
      "Thank you!"
    ].join("\n");
  }

  // -------- Clipboard --------
  async function copyToClipboard(text) {
    // Modern API
    if (navigator.clipboard && window.isSecureContext) {
      try {
        await navigator.clipboard.writeText(text);
        return true;
      } catch (_) {
        // fall through
      }
    }

    // Fallback
    const ta = document.createElement("textarea");
    ta.value = text;
    ta.setAttribute("readonly", "");
    ta.style.position = "fixed";
    ta.style.top = "-9999px";
    ta.style.left = "-9999px";
    document.body.appendChild(ta);
    ta.focus();
    ta.select();

    let ok = false;
    try {
      ok = document.execCommand("copy");
    } catch (_) {
      ok = false;
    }

    document.body.removeChild(ta);
    return ok;
  }

  // -------- Modals --------
  function openModal(modalEl) {
    if (!modalEl) return;
    modalEl.classList.add("open");
    document.body.style.overflow = "hidden";
  }
  function closeModal(modalEl) {
    if (!modalEl) return;
    modalEl.classList.remove("open");
    document.body.style.overflow = "";
  }

  // -------- Deep links (try app first) --------
  function openAppLink({ androidIntent, fallbackUrl }) {
  const isAndroid = /Android/i.test(navigator.userAgent);

  // If we can, try to open the native app first (Android). If the page becomes hidden,
  // we cancel the web fallback so it doesn't open an extra tab for no reason.
  if (isAndroid && androidIntent) {
    const timer = setTimeout(() => {
      window.open(fallbackUrl, "_blank", "noopener,noreferrer");
    }, 900);

    const onVis = () => {
      if (document.hidden) {
        clearTimeout(timer);
        document.removeEventListener("visibilitychange", onVis);
      }
    };
    document.addEventListener("visibilitychange", onVis);

    window.location.href = androidIntent;
    return;
  }

  window.open(fallbackUrl, "_blank", "noopener,noreferrer");
}

  function openInstagramDM() {
    openAppLink({
      androidIntent: "intent://ig.me/m/northstarclean17#Intent;scheme=https;package=com.instagram.android;end",
      fallbackUrl: "https://ig.me/m/northstarclean17"
    });
  }

  function openFacebookDM() {
    // Prefer Messenger app on Android
    openAppLink({
      androidIntent: "intent://m.me/Northstarclean17#Intent;scheme=https;package=com.facebook.orca;end",
      fallbackUrl: "https://www.facebook.com/messages/t/Northstarclean17"
    });
  }

  // -------- Wire up --------
  let lastBookingMessage = "";

  function openBookingFlow() {
    const est = renderEstimate();
    if (!est) {
      // nudge user to calculate with a valid area
      els.area.focus();
      return;
    }

    lastBookingMessage = buildBookingMessage(est);

    openModal(els.bookingModal);

    // Put message into the modal preview
    if (els.bookingMsgBox) els.bookingMsgBox.textContent = lastBookingMessage;

    // Copy immediately
    Promise.resolve(copyToClipboard(lastBookingMessage)).then((ok) => {
      if (els.bookingCopyStatus) {
        els.bookingCopyStatus.textContent = ok
          ? "Message copied. Tap Instagram or Facebook to send it."
          : "Couldn’t copy automatically. Tap “Copy again”.";
      }
      if (els.copyAgainBtn) els.copyAgainBtn.style.display = ok ? "none" : "inline-flex";
    });
  }

  // calculator
  els.calcBtn?.addEventListener("click", (e) => {
    e.preventDefault();
    renderEstimate();
  });

  // auto-update estimate on input changes (cheap + improves UX)
  ["input", "change"].forEach(evt => {
    ["bedrooms","bathrooms","kitchens","floors","diningRooms","basement","area"].forEach(id => {
      document.getElementById(id)?.addEventListener(evt, () => renderEstimate());
    });
  });

  // unit toggles
  els.unitSqftBtn?.addEventListener("click", () => setUnit("sqft"));
  els.unitM2Btn?.addEventListener("click", () => setUnit("m2"));

  // included modal
  els.includedBtn?.addEventListener("click", () => openModal(els.includedModal));
  els.closeModal?.addEventListener("click", () => closeModal(els.includedModal));
  els.includedModal?.addEventListener("click", (e) => {
    if (e.target === els.includedModal) closeModal(els.includedModal);
  });

  // booking modal open/close
  els.bookBtn?.addEventListener("click", (e) => {
    e.preventDefault();
    openBookingFlow();
  });

  els.closeBookingModal?.addEventListener("click", () => closeModal(els.bookingModal));
  els.bookingModal?.addEventListener("click", (e) => {
    if (e.target === els.bookingModal) closeModal(els.bookingModal);
  });

  // copy again
  els.copyAgainBtn?.addEventListener("click", async () => {
    if (!lastBookingMessage) return;
    const ok = await copyToClipboard(lastBookingMessage);
    if (els.bookingCopyStatus) {
      els.bookingCopyStatus.textContent = ok
        ? "Message copied. Tap Instagram or Facebook to send it."
        : "Copy failed. Please copy manually from the preview box.";
    }
    if (ok) els.copyAgainBtn.style.display = "none";
  });

  // DM buttons inside modal
  els.igDmBtn?.addEventListener("click", async (e) => {
    e.preventDefault();
    if (lastBookingMessage) await copyToClipboard(lastBookingMessage);
    openInstagramDM();
  });

  els.fbDmBtn?.addEventListener("click", async (e) => {
    e.preventDefault();
    if (lastBookingMessage) await copyToClipboard(lastBookingMessage);
    openFacebookDM();
  });

  // init
  setUnit("sqft");
  renderEstimate();
})();
</script>
<div aria-labelledby="bookingTitle" aria-modal="true" class="modal" id="bookingModal" role="dialog">
<div class="modalCard">
<div class="modalHeader">
<h3 id="bookingTitle">Finalize your booking</h3>
<button class="closeBtn" id="closeBookingModal" type="button">Close</button>
</div>
<div class="modalBody">
<div class="muted" style="margin-bottom:10px">To finalize your booking, send the copied message via Instagram or Facebook.</div>
<div class="copyRow">
<div class="statusOk" id="bookingCopyStatus"></div>
<button class="miniBtn" id="copyAgainBtn" type="button">Copy again</button>
</div>
<div class="actions">
<a class="contactBtn yellow" href="https://ig.me/m/northstarclean17" id="igDmBtn" rel="noopener" target="_blank">Message on Instagram</a>
<a class="contactBtn dark" href="https://www.facebook.com/messages/t/Northstarclean17" id="fbDmBtn" rel="noopener" target="_blank">Message on Facebook</a>
</div>
<div class="small" style="margin-top:10px">
          Tip: After opening the chat, tap and hold the message box, then choose <b>Paste</b>.
        </div>
<textarea class="msgBox" id="bookingMsgBox" readonly=""></textarea>
</div>
</div>
</div>
</body>
</html>
